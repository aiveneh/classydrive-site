{"ast":null,"code":"import { handleActions } from 'redux-actions';\nimport { createSelector } from 'reselect';\nimport { produce } from 'immer';\nimport { combineEpics } from 'redux-observable';\nimport { ofType, catchError, switchMap, of } from 'storejars-react-toolkit/dist/operators';\nimport { Actions, entitiesMeta, entities, responder, metas } from 'storejars-react-toolkit';\nimport { api, tokenStorage } from '../helpers';\nimport namespaces from '../namespaces';\nexport const action = new Actions(namespaces.USERS);\nexport const selector = createSelector(entities, state => state.users);\nexport const metaSelector = createSelector(entitiesMeta, state => state.users);\nexport const reducer = handleActions({\n  [action.read.success]: (state, action$) => produce(state, draft => {\n    draft.data = action$.payload;\n    return draft;\n  })\n}, {\n  data: []\n});\nexport const metaReducer = metas(action);\n\nfunction createEpic(action$) {\n  return action$.pipe(ofType(action.create.loading), switchMap(({\n    payload\n  }) => {\n    return api.post$('/users', payload).pipe(switchMap(({\n      response\n    }) => {\n      tokenStorage.set(response.data);\n      return of(action.createAction(response.data).success);\n    }), catchError(({\n      response\n    }) => of(action.createAction(responder(response)).error)));\n  }));\n}\n\nfunction readEpic(action$) {\n  return action$.pipe(ofType(action.read.loading), switchMap(() => {\n    return api.get$('/users').pipe(switchMap(({\n      response\n    }) => {\n      return of(action.readAction(response.data).success);\n    }), catchError(({\n      response\n    }) => of(action.readAction(responder(response)).error)));\n  }));\n}\n\nfunction deleteEpic(action$) {\n  return action$.pipe(ofType(action.read.loading), switchMap(({\n    payload\n  }) => {\n    return api.post$('/users', payload).pipe(switchMap(({\n      response\n    }) => {\n      return of(action.readAction(response.data).success);\n    }), catchError(({\n      response\n    }) => of(action.readAction(responder(response)).error)));\n  }));\n}\n\nexport const epic = combineEpics(readEpic, createEpic, deleteEpic);","map":{"version":3,"sources":["/Users/macbook/Documents/projects/classydrive/classydrive-web/site/src/redux/entities/users.ts"],"names":["handleActions","createSelector","produce","combineEpics","ofType","catchError","switchMap","of","Actions","entitiesMeta","entities","responder","metas","api","tokenStorage","namespaces","action","USERS","selector","state","users","metaSelector","reducer","read","success","action$","draft","data","payload","metaReducer","createEpic","pipe","create","loading","post$","response","set","createAction","error","readEpic","get$","readAction","deleteEpic","epic"],"mappings":"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","sourcesContent":["import { handleActions } from 'redux-actions';\nimport { createSelector } from 'reselect';\nimport { produce } from 'immer';\nimport { combineEpics } from 'redux-observable';\nimport { ofType, catchError, switchMap, of } from 'storejars-react-toolkit/dist/operators';\nimport { Actions, entitiesMeta, entities, responder, metas } from 'storejars-react-toolkit';\n\nimport { api, tokenStorage } from '../helpers';\nimport namespaces from '../namespaces';\n\nexport const action = new Actions(namespaces.USERS);\n\nexport const selector = createSelector(entities, (state) => state.users);\nexport const metaSelector = createSelector(entitiesMeta, (state) => state.users);\n\nexport const reducer = handleActions(\n  {\n    [action.read.success]: (state, action$) =>\n      produce(state, (draft) => {\n        draft.data = action$.payload;\n        return draft;\n      }),\n  },\n  { data: [] },\n);\n\nexport const metaReducer = metas(action);\n\nfunction createEpic(action$) {\n  return action$.pipe(\n    ofType(action.create.loading),\n    switchMap(({ payload }) => {\n      return api.post$('/users', payload).pipe(\n        switchMap(({ response }) => {\n          tokenStorage.set(response.data);\n          return of(action.createAction(response.data).success);\n        }),\n        catchError(({ response }) => of(action.createAction(responder(response)).error)),\n      );\n    }),\n  );\n}\n\nfunction readEpic(action$) {\n  return action$.pipe(\n    ofType(action.read.loading),\n    switchMap(() => {\n      return api.get$('/users').pipe(\n        switchMap(({ response }) => {\n          return of(action.readAction(response.data).success);\n        }),\n        catchError(({ response }) => of(action.readAction(responder(response)).error)),\n      );\n    }),\n  );\n}\n\nfunction deleteEpic(action$) {\n  return action$.pipe(\n    ofType(action.read.loading),\n    switchMap(({ payload }) => {\n      return api.post$('/users', payload).pipe(\n        switchMap(({ response }) => {\n          return of(action.readAction(response.data).success);\n        }),\n        catchError(({ response }) => of(action.readAction(responder(response)).error)),\n      );\n    }),\n  );\n}\n\nexport const epic = combineEpics(readEpic, createEpic, deleteEpic);\n"]},"metadata":{},"sourceType":"module"}