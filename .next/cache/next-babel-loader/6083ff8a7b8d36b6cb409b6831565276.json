{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _handleActions;\n\nimport { handleActions } from 'redux-actions';\nimport { createSelector } from 'reselect';\nimport { produce } from 'immer';\nimport { combineEpics } from 'redux-observable';\nimport { ofType, catchError, switchMap, of } from 'storejars-react-toolkit/dist/operators';\nimport { Actions, entitiesMeta, entities, responder, metas } from 'storejars-react-toolkit';\nimport { api } from '../helpers';\nimport namespaces from '../namespaces';\nexport var action = new Actions(namespaces.CARS);\nexport var selector = createSelector(entities, function (state) {\n  return state.cars;\n});\nexport var metaSelector = createSelector(entitiesMeta, function (state) {\n  return state.cars;\n});\nexport var reducer = handleActions((_handleActions = {}, _defineProperty(_handleActions, action.read.success, function (state, action$) {\n  return produce(state, function (draft) {\n    draft.data = action$.payload;\n    return draft;\n  });\n}), _defineProperty(_handleActions, action.readOne.success, function (state, action$) {\n  return produce(state, function (draft) {\n    draft.item = action$.payload;\n    return draft;\n  });\n}), _handleActions), {\n  data: [],\n  item: {\n    exteriorImages: [],\n    interiorImages: [],\n    pros: [],\n    cons: [],\n    features: []\n  },\n  similarCars: []\n});\nexport var metaReducer = metas(action);\n\nfunction readEpic(action$) {\n  return action$.pipe(ofType(action.read.loading), switchMap(function () {\n    return api.get$('/cars').pipe(switchMap(function (_ref) {\n      var response = _ref.response;\n      return of(action.readAction(response.data).success);\n    }), catchError(function (_ref2) {\n      var response = _ref2.response;\n      return of(action.readAction(responder(response)).error);\n    }));\n  }));\n}\n\nfunction readOneEpic(action$) {\n  return action$.pipe(ofType(action.readOne.loading), switchMap(function (_ref3) {\n    var payload = _ref3.payload;\n    return api.get$(\"/cars/\".concat(payload.id)).pipe(switchMap(function (_ref4) {\n      var response = _ref4.response;\n      return of(action.readOneAction(response.data).success);\n    }), catchError(function (_ref5) {\n      var response = _ref5.response;\n      return of(action.readOneAction(responder(response)).error);\n    }));\n  }));\n}\n\nfunction createEpic(action$) {\n  return action$.pipe(ofType(action.create.loading), switchMap(function (_ref6) {\n    var payload = _ref6.payload;\n    return api.multipartPost$('/cars', payload).pipe(switchMap(function (_ref7) {\n      var response = _ref7.response;\n      return of(action.createAction(response.data).success);\n    }), catchError(function (_ref8) {\n      var response = _ref8.response;\n      return of(action.createAction(responder(response)).error);\n    }));\n  }));\n}\n\nfunction updateEpic(action$) {\n  return action$.pipe(ofType(action.update.loading), switchMap(function (_ref9) {\n    var payload = _ref9.payload;\n    return api.patch$(\"/cars/\".concat(payload._id), payload).pipe(switchMap(function (_ref10) {\n      var response = _ref10.response;\n      return of(action.updateAction(response.data).success);\n    }), catchError(function (_ref11) {\n      var response = _ref11.response;\n      return of(action.updateAction(responder(response)).error);\n    }));\n  }));\n}\n\nexport var epic = combineEpics(readEpic, readOneEpic, createEpic, updateEpic);","map":{"version":3,"sources":["/Users/macbook/Documents/projects/classydrive/classydrive-web/site/src/redux/entities/cars.ts"],"names":["handleActions","createSelector","produce","combineEpics","ofType","catchError","switchMap","of","Actions","entitiesMeta","entities","responder","metas","api","namespaces","action","CARS","selector","state","cars","metaSelector","reducer","read","success","action$","draft","data","payload","readOne","item","exteriorImages","interiorImages","pros","cons","features","similarCars","metaReducer","readEpic","pipe","loading","get$","response","readAction","error","readOneEpic","id","readOneAction","createEpic","create","multipartPost$","createAction","updateEpic","update","patch$","_id","updateAction","epic"],"mappings":"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","sourcesContent":["import { handleActions } from 'redux-actions';\nimport { createSelector } from 'reselect';\nimport { produce } from 'immer';\nimport { combineEpics } from 'redux-observable';\nimport { ofType, catchError, switchMap, of } from 'storejars-react-toolkit/dist/operators';\nimport { Actions, entitiesMeta, entities, responder, metas } from 'storejars-react-toolkit';\n\nimport { api } from '../helpers';\nimport namespaces from '../namespaces';\n\nexport const action = new Actions(namespaces.CARS);\n\nexport const selector = createSelector(entities, (state) => state.cars);\nexport const metaSelector = createSelector(entitiesMeta, (state) => state.cars);\n\nexport const reducer = handleActions(\n  {\n    [action.read.success]: (state, action$) =>\n      produce(state, (draft) => {\n        draft.data = action$.payload;\n        return draft;\n      }),\n    [action.readOne.success]: (state, action$) =>\n      produce(state, (draft) => {\n        draft.item = action$.payload;\n        return draft;\n      }),\n  },\n  { data: [], item: { exteriorImages: [], interiorImages: [], pros: [], cons: [], features: [] }, similarCars: [] },\n);\n\nexport const metaReducer = metas(action);\n\nfunction readEpic(action$) {\n  return action$.pipe(\n    ofType(action.read.loading),\n    switchMap(() => {\n      return api.get$('/cars').pipe(\n        switchMap(({ response }) => {\n          return of(action.readAction(response.data).success);\n        }),\n        catchError(({ response }) => of(action.readAction(responder(response)).error)),\n      );\n    }),\n  );\n}\n\nfunction readOneEpic(action$) {\n  return action$.pipe(\n    ofType(action.readOne.loading),\n    switchMap(({ payload }) => {\n      return api.get$(`/cars/${payload.id}`).pipe(\n        switchMap(({ response }) => {\n          return of(action.readOneAction(response.data).success);\n        }),\n        catchError(({ response }) => of(action.readOneAction(responder(response)).error)),\n      );\n    }),\n  );\n}\n\nfunction createEpic(action$) {\n  return action$.pipe(\n    ofType(action.create.loading),\n    switchMap(({ payload }) => {\n      return api.multipartPost$('/cars', payload).pipe(\n        switchMap(({ response }) => {\n          return of(action.createAction(response.data).success);\n        }),\n        catchError(({ response }) => of(action.createAction(responder(response)).error)),\n      );\n    }),\n  );\n}\n\nfunction updateEpic(action$) {\n  return action$.pipe(\n    ofType(action.update.loading),\n    switchMap(({ payload }) => {\n      return api.patch$(`/cars/${payload._id}`, payload).pipe(\n        switchMap(({ response }) => {\n          return of(action.updateAction(response.data).success);\n        }),\n        catchError(({ response }) => of(action.updateAction(responder(response)).error)),\n      );\n    }),\n  );\n}\n\nexport const epic = combineEpics(readEpic, readOneEpic, createEpic, updateEpic);\n"]},"metadata":{},"sourceType":"module"}